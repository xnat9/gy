repositories {
    mavenLocal()
    maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
    // maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
    mavenCentral()
    jcenter()
}

version = '1.2.0'

//apply plugin: 'java'
apply plugin: 'groovy'

// 修改源目录
sourceSets {
    main {
        groovy {
            srcDir 'src'
        }
        resources {
            srcDir 'src/static'
        }
    }
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

dependencies {
    compile fileTree(dir: 'sysLib', include: ['*.jar'])
    compile 'org.codehaus.groovy:groovy:3.0.4'

    compile 'com.alibaba:fastjson:1.2.71'
    compile 'ch.qos.logback:logback-classic:1.2.3'
    compile 'cn.xnatural.enet:enet-event:0.0.14'
    compile 'org.hibernate:hibernate-core:5.4.17.Final'

    // 连接池
    // compile 'com.zaxxer:HikariCP:3.4.1'
    compile 'com.alibaba:druid:1.1.22'
    // compile 'org.apache.commons:commons-dbcp2:2.7.0'
    // compile 'mysql:mysql-connector-java:5.1.34'
    compile 'com.h2database:h2:1.4.200'

    compile 'io.netty:netty-all:4.1.49.Final'
    compile 'com.squareup.okhttp3:okhttp:3.14.8'
    // compile('org.apache.httpcomponents:httpclient:4.5.12')
    compile ('org.ehcache:ehcache:3.6.3') {exclude group:'org.slf4j'}
    compile ('org.quartz-scheduler:quartz:2.3.0') {
        exclude group:'org.slf4j'
        exclude group:'com.mchange'
        exclude group:'com.zaxxer'
    }
    compile 'redis.clients:jedis:3.3.0'

    // web 相关
    compile ('io.ratpack:ratpack-core:1.8.0') {
        exclude group: 'io.netty'
        exclude group: 'io.ratpack', module: 'ratpack-guice'
        //exclude group: 'com.google.guava'
        //exclude group: 'com.fasterxml.jackson.core'
        //exclude group: 'com.fasterxml.jackson.datatype'
        //exclude group: 'com.fasterxml.jackson.dataformat'
    }

    implementation('org.apache.commons:commons-lang3:3.10')

//    compile('org.webjars.npm:swagger-ui-dist:3.27.0')
//    compile('org.webjars:webjars-locator-core:0.40')
//    compile('org.webjars:jquery:3.1.1')

    // compile('commons-io:commons-io:2.7')

//    compile('io.projectreactor.netty:reactor-netty:0.9.5.RELEASE') {
//        exclude group: 'io.netty'
//    }
    // compile('com.bladejava:blade-mvc:2.0.15.BETA')

    // excel
    // compile 'org.apache.poi:poi:4.1.0'
    // compile 'org.apache.poi:poi-ooxml:4.1.0'

    // 异步sql
    // compile 'com.github.jasync-sql:jasync-mysql:1.0.12'

    // html 解析
    compile('org.jsoup:jsoup:1.12.1')

    // compile 'org.t-io:tio-core:3.6.0.v20200315-RELEASE'
    // compile 'org.t-io:tio-http-server:3.6.0.v20200315-RELEASE'
    // compile 'org.t-io:tio-websocket-server:3.6.0.v20200315-RELEASE'

    // compile 'org.smartboot.socket:aio-core:1.4.10'

    // compile 'cn.hutool:hutool-socket:5.3.3'

    // compile('com.alibaba:dubbo:2.6.8')
//    compile('commons-codec:commons-codec:1.14')

    // 工作流
//    compile('org.activiti:activiti-engine:7.0.0.GA') {
//        exclude group: 'org.mybatis'
//        exclude group: 'org.springframework'
//    }

    // 规则引擎
//    compile('org.drools:drools-core:7.37.0.Final')
//    compile('com.alibaba:QLExpress:3.2.4')

    // jvm 脚本语言
//    compile('com.googlecode.aviator:aviator:5.0.0')

    // 响应式
    //compile('io.reactivex.rxjava2:rxjava:2.2.19')
    //compile('io.projectreactor:reactor-core:3.3.5.RELEASE')
    //compile('io.rsocket:rsocket-core:1.0.0')

//    compile('io.vertx:vertx-core:3.9.0')

    // compile('org.jsoup:jsoup:1.13.1')
}


// 依赖copy
task deps(type: Copy) {
    new File('lib').deleteDir()
    from configurations.runtime
    into 'lib'
}


task tgz(dependsOn: ['deps'], type: Tar) {
    new File("${buildDir}/my.tgz").deleteOnExit()

    into("bin") {from("bin")}
    into("conf") {from "conf"}
    into("src") {from("src")}
    into("lib") {from "lib"}
    from "build.gradle"
    from "start.bat"
    from("start.sh")

    archiveFileName = "my.tgz"
    compression(Compression.GZIP)
    destinationDirectory = file("${buildDir}")
}


task tarDir(dependsOn: ['deps'], type: Copy) {
    new File("${buildDir}/my").deleteDir()

    into("bin") {from("bin")}
    into("conf") {from "conf"}
    into("src") {from("src")}
    into("lib") {from "lib"}
    from "build.gradle"
    from "start.bat"
    from("start.sh")

    into "${buildDir}/my"
}